\documentclass{beamer}

\mode<presentation>{
\usetheme{Madrid}
%\usecolortheme{beaver}
}
\usepackage[utf8]{inputenc}
%\usepackage{default}
%\usepackage[portuguese]{babel}
%\usepackage{pgfplots}
%\pgfplotsset{/pgf/number format/use comma,compat=newest}
%\usepackage{color}
\usepackage{amsfonts}
\usepackage{mathrsfs}  

%\usepackage{hyperref}


%MEUS COMANDOs

\usepackage{tikz}
\usetikzlibrary{quotes, angles, intersections}
\newcommand{\R}{\mathbb{R}}
\newcommand{\D}{\mathscr{D}}
\newcommand{\Pp}{\mathscr{P}}
\newcommand{\Cc}{\mathscr{C}}
\newcommand{\E}{\mathscr{E}}

\newcommand{\bigO}{\mathscr{O}}
\usetikzlibrary{matrix}
\usepackage{pgfplots}
\pgfplotsset{compat=1.4}
\usepackage{algorithm2e}
\usepackage{algorithmic}
\usepackage{float}
\usepackage{caption}
\newcommand{\source}[1]{\caption*{Source: {#1}} }

%\usepgfplotslibrary{external}
%\tikzexternalize
%\usepackage{natbib}

\usepackage[
backend=biber,style=authoryear,autocite=inline
]{biblatex}
%\DeclareLanguageMapping{english}{english-apa}

\addbibresource{../references.bib} %Imports bibliography file
%\DeclareLanguageMapping{american}{american-apa}



%FIM MEUS COMANDOS

\title[Qualificação de Mestrado]{Planar Maximal Covering with Ellipses}
\author[Tedeschi, D. F.]{Danilo F. Tedeschi\\ \small Orientadora: Dra. Marina Andretta}

\institute[ICMC]{Instituto de Ciências Matemáticas e Computação}
\date{\today}

\begin{document}

\begin{frame}
 \maketitle
 
 
\centering Agradecimentos à CAPES.
\end{frame}

\begin{frame}
\frametitle{Contents}
 \tableofcontents
\end{frame}

\section{Introduction}
\begin{frame}
\frametitle{Introduction}
\begin{itemize}
	\item Covering problems
	\begin{itemize}
		\item Minimum Cover Problem
		\item Maximal Covering Problem \autocite{church:1974}
	\end{itemize}
	\item Maximal Covering Location Problem (MCLP)
	\item Planar Maximal Covering Location Problem (PMCLP)
	\begin{itemize}
	\item One disk: $\bigO(n^2)$ and $\bigO(n^2\log{n})$ algorithms
	\item $m$ disks: $\bigO(n^{2m-1}\log{n})$ algorithm
	\end{itemize}
	\item Goals
	\begin{itemize}
		\item Develop a $\bigO(n^2\log{n})$ algorithm for the one disk case
		\item Adapt it for the $m$ ellipses case creating a $\bigO(n^{2m})$ algorithm
	\end{itemize}
\end{itemize}

\end{frame} 

\begin{frame}
	\begin{figure}
		\only<1>{\caption{Maximal cover by two disks.}}
		\only<2>{\caption{Minimum number of disks needed to cover the set of points.}}
		\only<1>{\input{figures/intro_a.tex}}
		\only<2>{\input{figures/intro_b.tex}}
		\source{Elaborated by the author.}
	\end{figure}
\end{frame}


\section{Preliminaries}

%\begin{frame}{Preliminaries}
	
%	\begin{block}{Norms}
%		Let $u \in \R^2$ and $Q$ a $2x2$ positive definite matrix
%		\begin{itemize}
%			\item Euclidean
%			\begin{equation*}
%			||u||_2 = \sqrt{u^Tu}
%			\end{equation*}
%			
%			\item Elliptical
%			\begin{equation*}
%			||u||_{Q} = \sqrt{u^TQu}
%			\end{equation*}
%		\end{itemize}
%	\end{block}

%\end{frame}





\section{Maximal Covering by Disks}
\begin{frame}{Maximal Covering by Disks}{One disk}
	
	$MCD(\Pp, 1)$ is the problem of placing one disk on the plane to cover a subset of a demand set $\Pp$ maximizing the weights of the covered points.
	
	\begin{equation*}\label{eq:max_one_disk}
		\max_q w(\Pp \cap D(q)),
	\end{equation*}
	
	\begin{itemize}
		\item $\Pp=\{p_1,\dots,p_n\}$ is the demand set with weights $w(p_i)>0$
		\item $w(A)$, $A\subset \Pp$, is the sum of weights of the points in $A$
		\item $D(q)$ is a unit disk with center at point $q$
		\item \autocite{chazelle:1986} proposed a $\bigO(n^2)$ algorithm
		\item \autocite{drezner} proposed a $\bigO(n^2\log{n})$ which our work is based on
		\item We will introduce an equivalent problem...
	\end{itemize}
\end{frame}

\subsection{Maximum Weight Clique Problem}
\begin{frame}{Maximum Weight Clique Problem}
	Let $\D=\{D_1,\dots,D_n\}$ be a set of $n$ unit disks with weights $w_i>0$. The maximum weight clique is defined as
	
	\begin{equation*}
	\max_q \sum_{D_k \cap q \neq \emptyset} w_k,
	\end{equation*}
	
	\begin{itemize}
		\item The disks are fixed with centers at $\Pp =\{p_1,\dots,p_n\}$ with $w_k=w(p_k)$
		\item A clique is a non-empty intersection area of a subset of disks. We search for only a point in an optimal clique.
		\item An optimal solution for the maximum weight clique is an optimal solution for $MCD(\Pp,1)$.
	\end{itemize}
\end{frame}

\begin{frame}{Maximum Weight Clique Problem}{Equivalence}
		\begin{figure}[H]
		\centering
		
		\only<1>{\caption{An instance of the Maximum Weight Clique Problem obtained from an instance of $MCD(\Pp, 1)$.}}
		
		\only<2>{\caption{An instance of the Maximum Weight Clique Problem obtained from an instance of $MCD(\Pp, 1)$. In gray, the optimal solution.}}
		
		\only<1>{\input{figures/max_w_clique_v2.tex}}
		\only<2>{\input{figures/max_w_clique_b.tex}}
      %\center{\includegraphics[width=.7\textwidth]{figures/mcd_instance.png}}
		\source{Elaborated by the author.}
		\label{fig:mcd_instance}
	\end{figure}
\end{frame}


\begin{frame}{Maximum Weight Clique Problem}{Algorithm}
	Defining $\Gamma_+(i,j)$ and $\Gamma_-(i,j)$:
	
	Let $D_i$ and $D_j$ be two unit disks that intersect at two points.
	
	\begin{itemize}
		\item Assume $D_i$ is at the origin
		\item We can find the polar angle of the intersection points. Let's call them $\Gamma_+(i,j)$ and $\Gamma_-(i,j)$ with the following condition:
		\begin{itemize}
			\item The arc defined by $\Gamma_+(i,j)$ and $\Gamma_-(i,j)$ bounds the region $D_i \cap D_j$
			
		\end{itemize}
		\item Later it will be shown how to find which one is which algorithmically.
	\end{itemize}
\end{frame}

\begin{frame}{Maximum Weight Clique Problem}{Algorithm}
	\begin{figure}[H]
		\centering
		
		\caption{Three disks and their intersection points and angles.}
		\input{figures/img2.tex}
		\source{Elaborated by the author.}
		\label{fig:3disks_intersect}
	\end{figure}
\end{frame}


\begin{frame}{Maximum Weight Clique Problem}{Algorithm}
	For a disk $D_i$, a counter-clockwise traversal visits every $\Gamma_+(i,j)$ and $\Gamma_-(i,j)$ in counter-clockwise order.
	
	\begin{itemize}
		\item An intersection region of disks is bounded by arcs.
		
		\item The arc $\Gamma_+(i,j),\Gamma_-(i,j)$ (counter-clockwise) determines a region where $i$ and $j$ intersect.
		
		\item In a counter-clockwise traversal, the arcs where $\Gamma_+(i,j) > \Gamma_-(i,j)$ can be a problem for the implementation. The traversal is on a circle, where to start?
		
		\item If the traversal reaches a opening angle, we mark the intersecting disk as active. If it reaches a closing angle we unmark it.
		
		\item We want to find a point in the traversal with the most active disks.
	\end{itemize}
\end{frame}

\begin{frame}{Maximum Weight Clique Problem}{Algorithm}
	
	For every disk, traverse the sorted list of intersection angles twice, keeping a set of active disks, and the current best solution.
	
	Doing the traversal twice solves the problem of deciding where to start.
	
\begin{figure}[H]
	\centering
	
	\caption{The intersections list of a disk with three other disks.}
	\input{figures/fig:array_disks.tex}
	\source{Elaborated by the author.}
	\label{fig:array_disks}
\end{figure}
\end{frame}

%\begin{frame}{Maximum Weight Clique Problem}{Algorithm}
%\begin{figure}
	%\centering
	
%	\caption{A traversal for $D_1$ with green disks representing the active set and red signs representing the current angle being visited (some are omitted).}
%	\input{figures/mcd_sim.tex}
%		\source{Elaborated by the author.}
	%\label{fig:array_disks}
%\end{figure}
%\end{frame}

\begin{frame}{Maximum Weight Clique Problem}{Algorithm}

	\begin{figure}
		\caption{A traversal for $D_1$ with green disks representing the active set and red signs representing the current angle being visited (some are omitted).}
		\only<1>{\input{figures/mcd_sim_1.tex}}
		\only<2>{\input{figures/mcd_sim_2.tex}}
		\only<3>{\input{figures/mcd_sim_2_5.tex}}
		\only<4>{\input{figures/mcd_sim_3.tex}}
		\only<5>{\input{figures/mcd_sim_4.tex}}
		\only<6>{\input{figures/mcd_sim_5.tex}}
		\only<7>{\input{figures/mcd_sim_6.tex}}
		\only<8>{\input{figures/mcd_sim_7.tex}}
			\source{Elaborated by the author.}
	\end{figure}
\end{frame}


\begin{frame}{Maximum Weight Clique Problem}{Algorithm}
	
	The run-time complexity of the algorithm is $\bigO(n^2\log{n})$.
	
	\begin{itemize}
		\item There are $\bigO(n^2)$ intersections among $n$ disks
		
		\item Sorting takes $\bigO(n^2\log{n})$
		
		\item The traversal takes $\bigO(n)$ for every disk.
		
		\item It can be implemented in $K\log{n}$ where $K$ is the number of intersections.
	\end{itemize}

\end{frame}

\begin{frame}{Maximum Covering by Disks}{Multiple disks}
	
	Works found in the literature:
	
	\begin{itemize}
		\item In \autocite{cabello:2006} a $\bigO(n^{2m-1})$ algorithm was proposed. Also a $(1-\epsilon)-$approximation that runs in $\bigO(n\log{n})$ was introduced.
		
		\item In \autocite{zhou} a heuristic method using an algorithm called mean-shift was developed. The mean-shift algorithm converges to a local density maxima of any probability distribution and it is used to find a smaller candidate list of centers for the disks.
	\end{itemize}
	
	Because of the similarities, we will discuss only the multiple ellipses algorithm later.
	
\end{frame}
\section{Maximal Covering by Ellipses}

\begin{frame}{Ellipses}
	
	\begin{block}{Ellipse}
		Given a center $c \in \R^2$ and $Q \in \R^ {2x2}$, an ellipse is the set of points that satisfy
		
		\begin{equation*}
		||u-c||_Q^2 = (u-c)^TQ(u-c) = 1,
		\end{equation*}
		
		with $\le$ representing the set of covered points
	\end{block}
	
	\begin{block}{Axis-parallel ellipse}
		Any $2$ by $2$ diagonal d.p. matrix determines an axis-parallel ellipse, which can also be described by
		
		\begin{equation*}
		\frac{(x-c_x)^2}{a^2} + \frac{(y-c_y)^2}{b^2} = 1,
		\end{equation*}
		
		where $(a,b)$ are the shape parameters and $c=(c_x,c_y)$ is the center.
	\end{block}
	
\end{frame}

\begin{frame}{Ellipses}
	\begin{figure}[H]
		\centering
		
		\caption{The ellipse seen as just a linear transformation of a circle.}
		\input{figures/elliptical.and.euclidean.norms.tex}
		\source{Elaborated by the author.}
		\label{fig:3ellipses_intersect}
		
	\end{figure}
\end{frame}



\begin{frame}{Maximal Covering by Ellipses}{One ellipse}
	Let $MCE(\Pp, a, b)$ be an instance of the maximal covering by one ellipse, with $E$ being an ellipse with shape parameters $(a,b) \in \R_{>0}^2$, an optimal solution of $MCE(\Pp, a, b)$ is given by
	
	\begin{equation*}
	\max_q |\Pp \cap (q)|,
	\end{equation*}

	\begin{itemize}
		\item $E(q)$ is an axis-parallel ellipse with center point $q$
		\item Assuming unit weights for now
		\item Same algorithm for one disk
	\end{itemize}

\end{frame}

\begin{frame}{Maximal Covering by Ellipses}{One ellipse}
\begin{figure}[H]
	\centering
	
	\caption{Intersection points of $E_1$ with $E_2$ and $E_3$ along with opening and closing angles indicators.}
	\input{figures/3ellipses_with_gammas.tex}
	\source{Elaborated by the author.}
	\label{fig:3ellipses_with_gammas}
\end{figure}
\end{frame}


\begin{frame}{Maximal Covering by Ellipses}{$m$ ellipses}
	Let $MCE(\Pp, \E)$ be an instance of the maximal covering by ellipses, an optimal solution is given by
	
	\begin{equation*}
	\max_{q_1, \dots, q_m}{\left|\bigcup_{i=1}^{m} \Pp \cap E_i(q_i)\right|},
	\end{equation*}
	
	\begin{itemize}
		\item $\E$ is a set of $m$ ellipses
		\item \autocite{canbolat} is the very first study on the problem. Slow exact method, a heuristic one was proposed.
		\item \autocite{andreta} proposed a method that breaks the problem into smaller optimization ones. Also, they developed a method for the non-axis-parallel case.
	\end{itemize}
\end{frame}

\begin{frame}[fragile]{Maximal Covering by Ellipses}{Pre-processing that finds every possible coverage for ellipse $E_i$}
	\begin{algorithm}[H]
		%\caption{Algorithm for $MCE(\Pp, a, b)$ with unit weights}\label{algoritmo:mce1}
		\begin{algorithmic}[1]
			\STATE $A \gets \bigcup_{j \in I_i} \{\Gamma_+(i,j) \cup \Gamma_-(i,j)\}$
			\STATE $Z \gets \{\}$
			
			\FOR{$cnt=1..2$} 
			\FOR{$a \in A$}
			\STATE Let $p_a$ be the point that intersects $E_i$ at angle $a$. 
			\IF{$a$ is a starting angle}
			\STATE $Cov \gets Cov \cup \{p_a\}$
			\ELSE
			\STATE $Cov \gets Cov \setminus \{p_a\}$
			\ENDIF
			\STATE $Z \gets Z \cup \{Cov\}$
			\ENDFOR
			\ENDFOR
			
		\end{algorithmic}
	\end{algorithm}
\end{frame}

\begin{frame}
	\begin{figure}
		\caption{Optimal solution with two ellipses for a random instance.}
		\input{figures/example_2_ellipses.tex}
		\source{Elaborated by the author.}
	\end{figure}
\end{frame}

\begin{frame}{Maximal Covering by Ellipses}
	
	\begin{itemize}
		\item The algorithm for $m$ ellipses tries every possible assignment of coverage for every one of the ellipses
		\item Run-time complexity of $\bigO(n^2)^m = \bigO(n^{2m})$
		
		\item Simpler than the $m$ disks algorithm proposed by \autocite{cabello:2006}. Achieves a similar complexity ($\bigO(n^{2m-1})$).
		
		\item Small improvements can be made in the pre-processing exhibited earlier in oder to reduce the size of the search space:
		\begin{itemize}
			\item Non-maximal coverage sets.
			\item Ellipses that are too distant do not need to be checked.
		\end{itemize}
	
		\item The unit-weight assumption can be easily dropped
	\end{itemize}
	
\end{frame}




\section{Future Work}

\begin{frame}{Future Work}
	Primary goals:
\begin{itemize}
	\item Study the $(1-\epsilon)$-approximation method for the planar covering with disks in \autocite{cabello:2006} and develop an adapted version of the algorithm for ellipses with the same time complexity of $\bigO(n\log{n})$.
	
	\item Develop an exact method for the version of the problem introduced in \autocite{andreta} where the ellipses can be freely rotated.
\end{itemize}
\end{frame}

\begin{frame}{Future Work}
	
	Secondary goals:
	\begin{itemize}
		 

	\item Develop a probabilistic approximation algorithm based on \autocite{aronov:2008} which proposed a Monte Carlo approximation for the problem of finding the deepest point in a arrangement of regions. The method runs in $\bigO(n\epsilon^2\log{n})$ and can be applied to solve the case with one ellipse. The case with more than one ellipse is left as a challenge for us for the next steps of our research.
	
	\item In \autocite{zhou}, the task of finding every center candidate, after eliminating all the non-essential ones, is done in $\bigO(n^5)$ run-time complexity. We want to generalize this for the elliptical distance function and achieve a better run-time complexity. We also intend to use the mean-shift algorithm to try to develop a greedy version for the ellipses version.
	
		\end{itemize}
\end{frame}

\begin{frame}[allowframebreaks]
%	\frametitle{References}
%\bibliographystyle{authoryear-comp}
%	\bibliography{../references.bib}
\printbibliography
\end{frame}

\end{document}