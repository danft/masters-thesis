\documentclass{beamer}

\usepackage{amsthm, amsfonts, amsmath, amssymb} % Pacote para a definicao dos ambientes matematicos
\usepackage[brazilian]{babel}
\usepackage[utf8]{inputenc}
\usepackage[mathscr]{eucal}
\usepackage{tikz}
\usetikzlibrary{quotes, angles, intersections}
\newcommand{\R}{\mathbb{R}}
\newcommand{\D}{\mathscr{D}}
\newcommand{\Pp}{\mathscr{P}}
\newcommand{\bigO}{\mathscr{O}}
\newcommand{\Cc}{\mathscr{C}}
\newcommand{\E}{\mathscr{E}}
\newcommand{\norm}[2][2]{\left\lVert#2\right\rVert_{#1}}

\author{Danilo Tedeschi\\Dra. Marina Andretta}
\title{Fixed-Shape Ellipse by Three Points}
\institute{Universidade de SÃ£o Paulo}
\date{25 de Outubro de 2019}

\begin{document}
	
	\begin{frame}[t,plain]
		\titlepage
	\end{frame}
	
	\begin{frame}{Introduction}
		The shape of an ellipse is given by its major-axis and minor-axis, $(a, b) \in \mathbb{R}^2$, with $a > b > 0$.
		
		\begin{figure}[H]
			\centering
			
			%\caption{The ellipse as a parametric curve.}
			\input{ellipse_figure.tex}
			\label{fig:ellipse_params}
			\caption{An ellipse with shape parameters $a$ and $b$.}
		\end{figure}
		
	\end{frame}

\begin{frame}{Introduction}
	Here, the shape will be fixed and the center and angle of rotation are free.
	
	\begin{figure}
	\centering
	
	%\caption{The ellipse as a parametric curve.}
	\includegraphics[scale=.5]{3ellipses.pdf}
	\label{fig:ell}
	\caption{A fix-shape ellipse at different centers and with different angles of rotation.}
	\end{figure}
\end{frame}

\begin{frame}{Introduction}{Problem definition}
Given three points $u, v, w \in \R^2$, and the shape $(a,b) \in \R^2$ of an ellipse:
	\begin{figure}
	\centering
	
	%\caption{The ellipse as a parametric curve.}
	\includegraphics[scale=.5]{e3psol1.pdf}
	\label{fig:e3psol1}
	\caption{An instance of the problem.}
\end{figure}
\end{frame}

\begin{frame}{Introduction}{Problem definition}
	A solution is given by the ellipse's center $q \in \R^2$ and the angle of rotation $\theta \in [0, \pi)$, such that $u, v, w$ lie on its border. \textbf{We want to find every solution!}
	\begin{figure}
		\centering
		
		%\caption{The ellipse as a parametric curve.}
		\includegraphics[scale=.5]{e3psol2.pdf}
		\label{fig:e3psol2}
		\caption{Every solution for the instance shown previously.}
	\end{figure}
\end{frame}

\begin{frame}{Introduction}
	The equation of an ellipse is given by:
	
	\begin{equation*}
	\frac{\left(\left[\begin{array}{c}
	x-q_x\\
	y-q_y
		\end{array}\right]^T
		\left[\begin{array}{c}
		\cos\theta\\
		\sin\theta
		\end{array}\right]
		\right)^2}{a^2}+\frac{\left(\left[\begin{array}{c}
		x-q_x\\
		q_y-y
		\end{array}\right]^T
		\left[\begin{array}{c}
		\sin\theta\\
		\cos\theta
		\end{array}\right]
		\right)^2}{b^2} = 1.
	\end{equation*}
	
	\begin{itemize}
		\item Fixing the points $u, v, w$, we get $3$ equations and $3$ unknowns $(q_x, q_y, \theta)$.
		\item Finding every solution is difficult.
	\end{itemize}
\end{frame}

\begin{frame}{Transforming the problem}
	Let's make the problem simpler by transforming it into a circle problem.
	
	An ellipse with shape $(a, b)$ can be transformed into a circle of radius $b$ through scaling the $x$-axis by $\frac{b}{a}$:
	\begin{figure}
		\centering
		
		%\caption{The ellipse as a parametric curve.}
		\includegraphics[scale=.5]{el1.pdf}
		\label{fig:el1}
		\caption{Turning an ellipse with shape $(a, b)$ into a circle of radius $b$.}
	\end{figure}
	
\end{frame}

\begin{frame}{Transforming the problem}
	
	Let's rotate the points instead of rotating the ellipse:
	
	\begin{figure}
		\centering
		%\caption{Transforming an ellipse into a circle. T1, T2, and T3 represent the steps of the transformation.}
		\includegraphics[scale=.5]{sol1}
		\caption{Three points at their initial location.}
		\label{fig:sol1}
	\end{figure}
\end{frame}

\begin{frame}{Transforming the problem}
	
	Firstly, we rotate leaving one point fixed at $(0, 0)$:
	
	\begin{figure}
		\centering
		%\caption{Transforming an ellipse into a circle. T1, T2, and T3 represent the steps of the transformation.}
		\includegraphics[scale=.5]{sol2}
		\caption{After rotation.}
		\label{fig:sol2}
	\end{figure}
\end{frame}

\begin{frame}{Transforming the problem}
	
	Then, we scale by $\frac{b}{a}$ and check the radius of the circle:
	
	\begin{figure}
		\centering
		%\caption{Transforming an ellipse into a circle. T1, T2, and T3 represent the steps of the transformation.}
		\includegraphics[scale=.5]{sol3}
		\caption{After scaling.}
		\label{fig:sol33}
	\end{figure}
\end{frame}

\begin{frame}{Transforming the problem}
	
	If the radius is $b$, the angle of rotation is a solution:
	
	\begin{figure}
		\centering
		%\caption{Transforming an ellipse into a circle. T1, T2, and T3 represent the steps of the transformation.}
		\includegraphics[scale=.5]{sol4}
		\caption{One solution for this instance.}
		\label{fig:sol4}
	\end{figure}
\end{frame}

\begin{frame}{Transforming the problem}
	Formally, we can transform the problem by:
	
	\begin{itemize}
		\item Translate the points so $u=(0, 0)$.
		\item Rotate by $\theta$ and scale the $x$-axis by $\frac{b}{a}$.
		\item Find the $\theta$'s which produce a circle with radius $b$.
	\end{itemize}

	This transformation is expressed by:
	
	\begin{equation*}\label{eq:trpnts}
	\varphi(p, \theta)=\left[\begin{array}{cc}
	\frac{b}{a}&0\\
	0&1
	\end{array}\right]
	\left[\begin{array}{cc}
	\cos{\theta}&\sin{\theta}\\
	-\sin{\theta}&\cos{\theta}
	\end{array}\right]\left[\begin{array}{c}
	p_x\\
	p_y
	\end{array}\right],
	\end{equation*}
	for $p=u, v, w$.
	
	\textbf{This is an one variable problem on a closed interval!}

\end{frame}
	
\begin{frame}{Fixed-shape ellipse by three points}
	There is a known formula for the radius of a circumscribed circle \cite[p.~189]{johnson1960}:

	\begin{equation*}
	R = \dfrac{\norm{\varphi(v, \theta)}\norm{\varphi(w, \theta)}\norm{\varphi(v, \theta)-\varphi(w, \theta)}   }{4A(\theta)}
	\end{equation*}
	
	\begin{itemize}
		\item $R$ is the radius.
		\item $A(\theta)$ is the area of the triangle defined by the points $\varphi(u, \theta), \varphi(v, \theta), \varphi(w, \theta)$.
	\end{itemize}
	\vspace{\baselineskip}
	

												
\end{frame}

\begin{frame}{Fixed-shape ellipse by three points}
We define the function $\xi : [0, \pi) \mapsto \R$:

	\begin{equation*}
	\xi(\theta) = 16b^2A(\theta)^2 - \norm{\varphi(v, \theta)}^2\norm{\varphi(w, \theta)}^2\norm{\varphi(v, \theta)-\varphi(w, \theta)}^2
	\end{equation*}
	
The roots of $\xi$ are solutions of our problem.
	\begin{figure}
	\centering

	%\caption{Transforming an ellipse into a circle. T1, T2, and T3 represent the steps of the transformation.}
	\includegraphics[scale=.5]{036}
	\caption{An example of $\xi$.}
%	\label{fig:circumscribed-circle}
\end{figure}
\end{frame}

\begin{frame}{Fixed-shape ellipse by three points}
	There is no clear pattern in $\xi$.
	\begin{itemize}
		\item It can be written as $\{\cos^j{x}\sin^k{x} : j, k \in \mathbb{N}\}$.
		\item Degree $6$, at most $12$ roots in $[0, 2\pi)$ \cite[p.~150]{powell}
	\end{itemize}
\begin{figure}
	\centering
	
	%\caption{Transforming an ellipse into a circle. T1, T2, and T3 represent the steps of the transformation.}
	\includegraphics[scale=.5]{035}
	\caption{Another example of $\xi$.}
	%	\label{fig:circumscribed-circle}
\end{figure}
\end{frame}

\begin{frame}{Fixed-shape ellipse by three points}
	An example with two roots.
	\begin{figure}
		\centering
		
		%\caption{Transforming an ellipse into a circle. T1, T2, and T3 represent the steps of the transformation.}
		\includegraphics[scale=.5]{012}
		\caption{Yet another example of $\xi$.}
		%	\label{fig:circumscribed-circle}
	\end{figure}
\end{frame}

\begin{frame}{Polynomial Interpolation}
	It is a way to approximate a function by a simpler one (a polynomial).
	
	\begin{itemize}
		\item A degree $n$ of the interpolation is determined.
		\item $n+1$ points are chosen, such that the polynomial has to pass through.
		\item Can be calculated using Lagrange's formula.
		
		\item We can find every root of a polynomial by determining the eigenvalues of a matrix called The Companion Matrix \cite[p.~195]{horn}.
		
		\item Depending on the points, the interpolation can be a bad approximation. It can get worse even if $n$ is increased (Runge's Phenomenon) \cite[p.~37]{powell}.
	\end{itemize}
\end{frame}

\begin{frame}{Chebyshev Interpolation}
	
	\begin{block}{Chebyshev Polynomial}
		$T_n: [-1, 1] \mapsto [-1, 1]$ is the $n$-degree Chebyshev polynomial \cite{chebbook}:
		\begin{equation*}
		T_n(\cos t) = \cos(nt)
		\end{equation*}
	\end{block}
	Also, it can be defined recursively:	
	\begin{align*}
	&T_0(x) = 1\\
	&T_1(x) = x\\
	&T_n(x) = 2xT_{n-1}(x) - T_{n-2}(x)
	\end{align*}
	
\end{frame}

\begin{frame}{Chebyshev Interpolation}
\begin{figure}
	\centering
	
	%\caption{Transforming an ellipse into a circle. T1, T2, and T3 represent the steps of the transformation.}
	\includegraphics[scale=.6]{chebpoly}
	\caption{Chebyshev Polynomials of degree $1, 2, 3, 4$.}
	%	\label{fig:circumscribed-circle}
\end{figure}
\end{frame}

\begin{frame}{Chebyshev Interpolation}
	Interpolation on the roots of $T_n$, also known as Chebyshev Nodes:
	
	\begin{equation*}
		x_k = \cos\left(\pi\frac{2k - 1}{2n}\right)
	\end{equation*}
	
	The interpolation of a function $f : [-1, 1] \mapsto \R$ can be written directly using Chebyshev polynomial as basis:
	
	\begin{equation*}
	f(x) \approx \sum_{k=0}^{n} a_k T_k(x)
	\end{equation*}
	
	\begin{itemize}
		\item A simple change of coordinates lets the interpolation to be done on any closed interval!
		\item This can be done in $\bigO(n^3)$ \cite{boyd:2013}.
	\end{itemize}
\end{frame}

\begin{frame}{Chebyshev Interpolation}
		Why is it good?
	
	\begin{itemize}
		\item Numerically stable! Way better then polynomials in the power format \cite{gautschi:1979}.
		
		\item No Runge's Phenomenon, the interpolation converges to $f$.
		\begin{itemize}
			\item $\bigO(n^{-m})$ if $f$ is $m$ times differentiable \cite[p.~28]{gottlieb}.
			\item $\bigO(C^n)$, for $C<1$, if $f$ is analytical in a neighborhood of $[-1, 1]$ \cite{battles:2004}.
		\end{itemize}
		
		\item Very used in practice: present in external libraries like NumPy for Python.
	\end{itemize}
\end{frame}

\begin{frame}{Chebyshev Interpolation}
	Choosing the degree of the interpolation:
	
	\begin{itemize}
		\item There is no guaranteed way to choose it.
		\item A good rule is to examine the last coefficient (the last coefficient rule-of-thumb \cite[p~.50]{boyd:2001}).
		\item For a predefined $\epsilon$, choose $n$, such that:
		
		\begin{equation*}
		|a_n| \le \epsilon
		\end{equation*}
		
		\item There are other ways like checking the error on a Lobatto grid \cite{boyd:2007}.
	\end{itemize}
\end{frame}

\begin{frame}{Chebyshev Interpolation}
	For $n=32$, a precision of $10^{-10}$ is expected.
	
	\begin{figure}
		\centering
		
		%\caption{Transforming an ellipse into a circle. T1, T2, and T3 represent the steps of the transformation.}
		\includegraphics[scale=.6]{error_coef}
		\caption{$|a_n|$ for the interpolation of $\xi$ for an instance.}
		%	\label{fig:circumscribed-circle}
	\end{figure}
\end{frame}

\begin{frame}{Chebyshev Interpolation}{Roots}
	The roots of a Chebyshev polynomial can be found though determining the eigenvalues of a Chebyshev companion matrix \cite{boyd:2013}. This is it for $n=5$:
	
	\begin{equation*}
	\left[\begin{array}{cccccc}
	0&1&0&0&0\\
	\frac{1}{2} & 0 & \frac{1}{2} & 0 & 0\\
	0 & \frac{1}{2} & 0 & \frac{1}{2} & 0\\
	0 & 0 & \frac{1}{2} & 0 & \frac{1}{2}\\
	-\frac{a_0}{2a_5} & -\frac{a_1}{2a_5} &-\frac{a_2}{2a_5} &-\frac{a_3}{2a_5} &-\frac{a_4}{2a_5}\\
	\end{array}\right]
	\end{equation*}
	
	\begin{itemize}
		\item This matrix is a Hessenberg matrix.
		\item Its eigenvalues can be found by a QR decomposition in $\bigO(n^3)$.
	\end{itemize}
\end{frame}

\begin{frame}{Chebyshev Interpolation}{Roots}
	The largest error on roots that were found for $n=32$ is around $10^{-14}$ for an instance:
	\begin{figure}
		\centering
		
		%\caption{Transforming an ellipse into a circle. T1, T2, and T3 represent the steps of the transformation.}
		\includegraphics[scale=.6]{error_roots}
		\caption{$|\xi(\hat{\theta})|$, where $\hat{\theta}$ is a root of $f_n$.}
		%	\label{fig:circumscribed-circle}
	\end{figure}
\end{frame}

\begin{frame}{Chebyshev Interpolation}{Roots}
	The experiments were made using Python with the NumPy library. The running time is really low, even for $n=64$.
	\begin{figure}
		\centering
		
		%\caption{Transforming an ellipse into a circle. T1, T2, and T3 represent the steps of the transformation.}
		\includegraphics[scale=.6]{running_time}
		\caption{The running time to find the roots of $f_n$.}
		%	\label{fig:circumscribed-circle}
	\end{figure}
\end{frame}

\begin{frame}{Example}
	An example with $4$ solutions.
	\begin{figure}
		\centering
		
		%\caption{Transforming an ellipse into a circle. T1, T2, and T3 represent the steps of the transformation.}
		\includegraphics[scale=.6]{e3psol012}
		\caption{An example with $4$ solutions.}
		%	\label{fig:circumscribed-circle}
	\end{figure}
\end{frame}

\begin{frame}[allowframebreaks]
	\frametitle{References}
	\bibliographystyle{amsalpha}
	\bibliography{references}
\end{frame}
	
\end{document}