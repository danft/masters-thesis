%% This is file `elsarticle-template-1-num.tex',
%%
%% Copyright 2009 Elsevier Ltd
%%
%% This file is part of the 'Elsarticle Bundle'.
%% ---------------------------------------------
%%
%% It may be distributed under the conditions of the LaTeX Project Public
%% License, either version 1.2 of this license or (at your option) any
%% later version.  The latest version of this license is in
%%    http://www.latex-project.org/lppl.txt
%% and version 1.2 or later is part of all distributions of LaTeX
%% version 1999/12/01 or later.
%%
%% Template article for Elsevier's document class `elsarticle'
%% with numbered style bibliographic references
%%
%% $Id: elsarticle-template-1-num.tex 149 2009-10-08 05:01:15Z rishi $
%% $URL: http://lenova.river-valley.com/svn/elsbst/trunk/elsarticle-template-1-num.tex $
%%
\documentclass[a4]{elsarticle}

%% Use the option review to obtain double line spacing
%% \documentclass[preprint,review,12pt]{elsarticle}

%% Use the options 1p,twocolumn; 3p; 3p,twocolumn; 5p; or 5p,twocolumn
%% for a journal layout:
%% \documentclass[final,1p,times]{elsarticle}
%% \documentclass[final,1p,times,twocolumn]{elsarticle}
%% \documentclass[final,3p,times]{elsarticle}
%% \documentclass[final,3p,times,twocolumn]{elsarticle}
%% \documentclass[final,5p,times]{elsarticle}
%% \documentclass[final,5p,times,twocolumn]{elsarticle}

%% The graphicx package provides the includegraphics command.
\usepackage{graphicx}
%% The amssymb package provides various useful mathematical symbols
\usepackage{amssymb}
%% The amsthm package provides extended theorem environments
%% \usepackage{amsthm}

%% The lineno packages adds line numbers. Start line numbering with
%% \begin{linenumbers}, end it with \end{linenumbers}. Or switch it on
%% for the whole article with \linenumbers after \end{frontmatter}.
%\usepackage{lineno}

%% natbib.sty is loaded by default. However, natbib options can be
%% provided with \biboptions{...} command. Following options are
%% valid:

%%   round  -  round parentheses are used (default)
%%   square -  square brackets are used   [option]
%%   curly  -  curly braces are used      {option}
%%   angle  -  angle brackets are used    <option>
%%   semicolon  -  multiple citations separated by semi-colon
%%   colon  - same as semicolon, an earlier confusion
%%   comma  -  separated by comma
%%   numbers-  selects numerical citations
%%   super  -  numerical citations as superscripts
%%   sort   -  sorts multiple citations according to order in ref. list
%%   sort&compress   -  like sort, but also compresses numerical citations
%%   compress - compresses without sorting
%%
%% \biboptions{comma,round}

% \biboptions{}

\journal{EJOR}

\usepackage[mathscr]{eucal}
\newcommand{\R}{\mathbb{R}}
\newcommand{\Co}{\mathbb{Co}}
\newcommand{\D}{\mathscr{D}}
\newcommand{\Pp}{\mathscr{P}}
\newcommand{\Cc}{\mathscr{C}}
\newcommand{\E}{\mathscr{E}}
\newcommand{\F}{\mathscr{F}}
\newcommand{\Ww}{\mathscr{W}}
\newcommand{\Rr}{\mathscr{R}}
\newcommand{\norm}[2][2]{\left\lVert#2\right\rVert_{#1}}
\newcommand{\bigO}{\mathscr{O}}

\begin{document}
	
	\begin{frontmatter}
		
		%% Title, authors and addresses
		
		\title{Algorithms for Planar Maximum Covering Location by Ellipses Problems\tnoteref{t1}}
		\tnotetext[t1]{This paper is the results of the research
			project funded by CAPES.}
		
		%% use the tnoteref command within \title for footnotes;
		%% use the tnotetext command for the associated footnote;
		%% use the fnref command within \author or \address for footnotes;
		%% use the fntext command for the associated footnote;
		%% use the corref command within \author for corresponding author footnotes;
		%% use the cortext command for the associated footnote;
		%% use the ead command for the email address,
		%% and the form \ead[url] for the home page:
		%%
		%% \title{Title\tnoteref{label1}}
		%% \tnotetext[label1]{}
		%% \author{Name\corref{cor1}\fnref{label2}}
		%% \ead{email address}
		%% \ead[url]{home page}
		%% \fntext[label2]{}
		%% \cortext[cor1]{}
		%% \address{Address\fnref{label3}}
		%% \fntext[label3]{}
		
		
		%% use optional labels to link authors explicitly to addresses:
		%% \author[label1,label2]{<author name>}
		%% \address[label1]{<address>}
		%% \address[label2]{<address>}
		
		\author[1]{Danilo Tedeschi}
		\ead{danilo.tedeschi@usp.br}

		
		\author[2]{Marina Andretta}
		\ead{andretta@gmail.com}
					
		\address{Department of Applied Mathematics and Statistics, Institute of Mathematical and Computer Sciences, University of São Paulo, Avenida Trabalhador São-carlense, 400, Centro, 13566-590, São Carlos, SP, Brazil.}
		%\author{John Smith}
		
		%address{California, United States}
		
		\begin{abstract}
			%% Text of abstract
			Planar Maximum Covering Location by Ellipses is an optimization problem where one wants to place fixed shape ellipses on the plane to cover demand points
			maximizing a function depending on the value of covered points.
			We propose new exact algorithms for two versions of this problem, one where the ellipses have to be parallel to the coordinate axis, and another where they can be freely rotated. 
			Besides finding optimal solutions for previously published instances, including the ones where no optimal solution was known, both algorithms proposed by us were able to obtain optimal solutions for some new larger instances having with up to seven hundred demand points and five ellipses.
		\end{abstract}
		
		\begin{keyword}
			Optimization \sep Covering \sep Combinatorial Optimization
			%% keywords here, in the form: keyword \sep keyword
			
			%% MSC codes here, in the form: \MSC code \sep code
			%% or \MSC[2008] code \sep code (2000 is the default)
			
		\end{keyword}
		
	\end{frontmatter}
	
	%%
	%% Start line numbering here if you want
	%%
	%\linenumbers
	
	%% main text
	\section{Introduction}
	
	The Planar Maximum Covering Location Problem (PMCLP) was first introduced in \cite{church:1984}, and can be seen as a category of problems where the coverage of a demand set, a collection of subsets of $\R^2$, is to be maximized by determining the location of facilities in $\R^2$, with coverage being determined by a distance function.
	In \cite{church:1984}, methods for Euclidean and Rectilinear distances versions of the problem were proposed.
	In \cite{drezner, chazelle:1986}, exact algorithms for the Euclidean PMCLP with only one facility are proposed; and in \cite{cabello:2006} an approximation algorithm is proposed for the version with multiple unit disks as facilities.
	A property of the Euclidean PMCLP, which is utilized in the algorithms developed in \cite{drezner, chazelle:1986, cabello:2006}, and in the method proposed in \cite{church:1984}, is that there is an optimal solution which every facility is located in the demand points, or in the intersection of two circles centered at two demand points; we will prove a similar property for ellipses in our work.
	
	It is fair to say that PMCLP with elliptical coverage has not been vastly studied as only two articles have been found on it. In \cite{canbolat}, a mixed-integer non-linear programming method was proposed as a first approach to the problem. For some instances, the method took too long and did not find an optimal solution. Because of that, a heuristic method was developed using a technique called Simulated Annealing, which was able to obtain solutions for the instances proposed in that study.
	The problem was further explored in \cite{andreta}, which introduced the version where the ellipses can be freely rotated, to which an exact and a heuristic method was proposed, and developed a new method for the axis-parallel version of the problem, which was able to obtain optimal solutions for instances that the method proposed by \cite{canbolat} could not.
	The exact method for the version with rotation could not obtain optimal solutions within a predefined time limit for several instances, the heuristic method though returned solutions for every instance, and impressively enough, obtained optimal solutions for every verifiable instance.
	
	We study two versions of PMCLP with elliptical coverage facilities in this work. For both of them, each ellipse is defined to have a fixed shape and an undefined location, which is part of the solution.
	In the first version, introduced in \cite{canbolat}, all the ellipses are restricted to be axis-parallel, while in the second version, introduced in \cite{andreta}, this constraint is dropped, and all the ellipses can be freely rotated.
	The first version will be referred to as Planar Maximum Covering Location by Ellipses Problem (MCE) and the second one as  Planar Maximum Covering Location by Ellipses with Rotation Problem (MCER).
	
	\section{Problem Definition}
	
	An instance of MCE and MCER is given by $n$ demand points $\Pp=\{p_1, \dots, p_n\}$, $p_j\in\R^2$; $n$ weights $\Ww=\{w_1, \dots, w_n\}$, with $w_j\in\R$, $w_j>0$ being the weight of the $j$-th point; and $m$ shape parameters $\Rr=\{(a_1, b_1), \dots, (a_m, b_m)\}$, with $(a_j, b_j)$ being the semi-major and semi-minor of the $j$-th ellipse, with $a_j > b_j$. We define a list of functions $\E=\{E_1, \dots, E_m\}$ representing the coverage area of each facility. For MCE $E_j\colon\R^2\to\R^2$ is defined as
	\begin{equation}
	E_j(q) = \{p \in \R^2 \colon (p_x-q_x)^2/a_j^2 + (p_y-q_y)^2/b_j^2 \le 1\}.
	\end{equation}
	For MCER, we define $E_j \colon \R^2 \to \R^2 \times [0, \pi)$ as
	\begin{equation}
		E_j(q, \theta) = \left\{p \in \R^2 \colon 
		\left|\left|
		\left(
		\begin{array}{rr}
		\cos{\theta}/a_j & \sin{\theta}/a_j\\
		\sin{\theta}/b_j & -\cos{\theta}/b_j
		\end{array}
		\right)
		\left(
		\begin{array}{c}
		p_x-q_x\\
		p_y-q_y
		\end{array}
		\right)
		\right|\right|_2
		\le 1
		\right\}.
	\end{equation}
	
Let $w : A \subset \Pp \to \R$ be a function which takes a subset of the demand set and returns the sum of the weights of the points in $A$. Then, we define MCE as the optimization problem 
\begin{equation}
\max_{q_1, \dots, q_m} \sum_{j=1}^m w(\Pp \cap E_j(q_j)),
\end{equation}
and similarly MCER as
\begin{equation}
\max_{(q_1, \theta_1), \dots, (q_m, \theta_m)} \sum_{j=1}^m w(\Pp \cap E_j(q_j, \theta_j)).
\end{equation}

To make the notation more clear, we denote an instance of MCE or MCER as the tuple $(\Pp, \Ww, \Rr)$, and a solution of MCE as $Q:=(q_1, \dots, q_m)$, and a solution of MCER as $Q:=((q_1, \theta_1); \dots; (q_m, \theta_m))$.

\section{An algorithm for MCE}

We will develop a method which is similar to the one developed in \cite{drezner} for only one euclidean disk, and the exact algorithm developed for multiple Euclidean disks in \cite{cabello:2006}. 
We first describe a Candidate List set (CLS) for each facility, which is finite set of possible locations for each ellipse, which we use to converting MCE into a discrete optimization problem. We, then prove that using the possible solutions obtained from the combination of every ellipse's CLS an optimal solution can be obtained.

%\subsection{An equivalent problem}

Let $(\Pp, \Ww, \Rr)$ be an instance of MCE, then for each $j=1\dots m$, consider $n$ ellipses with shape parameters $(a_j, b_j)$ centered at each one of the points in $\Pp$. Then, if we have $q_j\in\R^2$ and $X \subset \{1, \dots, n\}$, such that $q_j \in \cap_{i\in X}E_j(p_i)$. That is $q_j$ lies in the intersection of a subset of the ellipses centered at $\Pp$. Then $\Pp \cap E_j(q_j) = \{p_i \colon i \in X\}$, that is, if we place an ellipse at $q_j$, it will cover the points which are centers of the ellipses centered at $\Pp$ that contain $q_j$.
From that observation, we can constrain each $q_j$ to be in $\cap_{i\in X} E_j(p_i)$, for some $X \subset \{1, \dots,n\}$, $X \neq \emptyset$.

Let $(\R^2, ||\cdot||)$ be a strictly convex normed plane, and $\D=\{D_1(p_1), \dots, D_n(p_n)\}$ be a set of $n$ unit disks in that space, with the condition that  $\cap_{D\in\D} D \neq \emptyset$. In \cite{bi}, we have the following results about $\cap_{D \in \D} D$:
\begin{itemize}
	\item The $\partial \cap_{D \in \D} D$ is formed by arcs of $D_1(p_1), \dots, D_n(p_n)$.
	\item The vertices of $\partial \cap_{D \in \D} D$ is contained in the set of pairwise-intersection of the circles $\partial D_1(p_1), \dots, \partial D_n(p_n)$.
\end{itemize}
	
\section{References}
	%% New version of the num-names style
	\bibliographystyle{elsarticle-num-names}
	\bibliography{../references.bib}
	
\end{document}

%%
%% End of file `elsarticle-template-1-num.tex'.